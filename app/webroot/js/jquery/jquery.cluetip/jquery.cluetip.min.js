(function(f){f.cluetip={version:"1.1pre"};var j,i,h,e,g,b,k,d;var c="appendTo",a="body";f.fn.cluetip=function(o,l){if(typeof o=="object"){l=o;o=null}if(o=="destroy"){return this.removeData("cluetip").unbind(".cluetip")}l=f.extend(true,{},f.fn.cluetip.defaults,l||{});if(!f("#cluetip").length){f(['<div id="cluetip">','<div id="cluetip-outer">','<h3 id="cluetip-title"></h3>','<div id="cluetip-inner"></div>',"</div>",'<div id="cluetip-extra"></div>','<div id="cluetip-arrows" class="cluetip-arrows"></div>',"</div>"].join(""))[c](a).hide();var n=+l.cluezIndex;j=f("#cluetip").css({position:"absolute"});h=f("#cluetip-outer").css({position:"relative",zIndex:n});i=f("#cluetip-inner");e=f("#cluetip-title");g=f("#cluetip-arrows");b=f('<div id="cluetip-waitimage"></div>').css({position:"absolute"}).insertBefore(j).hide()}var p=(parseInt(j.css("paddingLeft"),10)||0)+(parseInt(j.css("paddingRight"),10)||0);this.each(function(L){var w=this,z=f(this);var J=f.extend(true,{},l,f.metadata?z.metadata():f.meta?z.data():{});var s=false;n=+J.cluezIndex;z.data("cluetip",{title:w.title,zIndex:n});var T=false,S=0;var H=z.attr(J.attribute),v=J.cluetipClass;if(!H&&!J.splitTitle&&!o){return true}if(J.local&&J.localPrefix){H=J.localPrefix+H}if(J.local&&J.hideLocal){f(H+":first").hide()}var I=parseInt(J.topOffset,10),E=parseInt(J.leftOffset,10);var D,U,B=isNaN(parseInt(J.height,10))?"auto":(/\D/g).test(J.height)?J.height:J.height+"px";var q,x,M,Z,O,V;var C=parseInt(J.width,10)||275,W=C+p+J.dropShadowSteps,F=this.offsetWidth,y,N,aa,P,r;var R;var K=(J.attribute!="title")?z.attr(J.titleAttribute):"";if(J.splitTitle){if(K==undefined){K=""}R=K.split(J.splitTitle);K=R.shift()}if(J.escapeTitle){K=K.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;")}var u;function Y(){return false}var A=function(ab){if(!J.onActivate(z)){return false}T=true;j.removeClass().css({width:C});if(H==z.attr("href")){z.css("cursor",J.cursor)}if(J.hoverClass){z.addClass(J.hoverClass)}x=M=z.offset().top;y=z.offset().left;P=ab.pageX;O=ab.pageY;if(w.tagName.toLowerCase()!="area"){q=f(document).scrollTop();r=f(window).width()}if(J.positionBy=="fixed"){N=F+y+E;j.css({left:N})}else{N=(F>y&&y>W)||y+F+W+E>r?y-W-E:F+y+E;if(w.tagName.toLowerCase()=="area"||J.positionBy=="mouse"||F+W>r){if(P+20+W>r){j.addClass(" cluetip-"+v);N=(P-W-E)>=0?P-W-E-parseInt(j.css("marginLeft"),10)+parseInt(i.css("marginRight"),10):P-(W/2)}else{N=P+E}}var ac=N<0?ab.pageY+I:ab.pageY;j.css({left:(N>0&&J.positionBy!="bottomTop")?N:(P+(W/2)>r)?r/2-W/2:Math.max(P-(W/2),0),zIndex:z.data("cluetip").zIndex});g.css({zIndex:z.data("cluetip").zIndex+1})}U=f(window).height();if(o){if(typeof o=="function"){o=o.call(w)}i.html(o);Q(ac)}else{if(R){var ae=R.length;i.html(ae?R[0]:"");if(ae>1){for(var ad=1;ad<ae;ad++){i.append('<div class="split-body">'+R[ad]+"</div>")}}Q(ac)}else{if(!J.local&&H.indexOf("#")!==0){if(/\.(jpe?g|tiff?|gif|png)$/i.test(H)){i.html('<img src="'+H+'" alt="'+K+'" />');Q(ac)}else{if(s&&J.ajaxCache){i.html(s);Q(ac)}else{var ai=J.ajaxSettings.beforeSend,af=J.ajaxSettings.error,ag=J.ajaxSettings.success,al=J.ajaxSettings.complete;var ak={cache:false,url:H,beforeSend:function(am){if(ai){ai.call(w,am,j,i)}h.children().empty();if(J.waitImage){b.css({top:O+20,left:P+20,zIndex:z.data("cluetip").zIndex-1}).show()}},error:function(am,an){if(T){if(af){af.call(w,am,an,j,i)}else{i.html("<i>sorry, the contents could not be loaded</i>")}}},success:function(am,an){s=J.ajaxProcess.call(w,am);if(T){if(ag){ag.call(w,am,an,j,i)}i.html(s)}},complete:function(ao,aq){if(al){al.call(w,ao,aq,j,i)}var ap=i[0].getElementsByTagName("img");d=ap.length;for(var an=0,am=ap.length;an<am;an++){if(ap[an].complete){d--}}if(d&&!f.browser.opera){f(ap).bind("load error",function(){d--;if(d<1){b.hide();if(T){Q(ac)}}})}else{b.hide();if(T){Q(ac)}}}};var ah=f.extend(true,{},J.ajaxSettings,ak);f.ajax(ah)}}}else{if(J.local){var aj=f(H+(/#\S+$/.test(H)?"":":eq("+L+")")).clone(true).show();if(J.localIdSuffix){aj.attr("id",aj[0].id+J.localIdSuffix)}i.html(aj);Q(ac)}}}}};var Q=function(ad){j.addClass("cluetip-"+v);if(J.truncate){var ae=i.text().slice(0,J.truncate)+"...";i.html(ae)}function ab(){}K?e.show().html(K):(J.showTitle)?e.show().html("&nbsp;"):e.hide();if(J.sticky){var ac=f('<div id="cluetip-close"><a href="#">'+J.closeText+"</a></div>");(J.closePosition=="bottom")?ac.appendTo(i):(J.closePosition=="title")?ac.prependTo(e):ac.prependTo(i);ac.bind("click.cluetip",function(){G();return false});if(J.mouseOutClose){j.bind("mouseleave.cluetip",function(){G()})}else{j.unbind("mouseleave.cluetip")}}var af="";h.css({zIndex:z.data("cluetip").zIndex,overflow:B=="auto"?"visible":"auto",height:B});D=B=="auto"?Math.max(j.outerHeight(),j.height()):parseInt(B,10);Z=M;V=q+U;if(J.positionBy=="fixed"){Z=M-J.dropShadowSteps+I}else{if((N<P&&Math.max(N,0)+W>P)||J.positionBy=="bottomTop"){if(M+D+I>V&&O-q>D+I){Z=O-D-I;af="top"}else{Z=O+I;af="bottom"}}else{if(M+D+I>V){Z=(D>=U)?q:V-D-I}else{if(z.css("display")=="block"||w.tagName.toLowerCase()=="area"||J.positionBy=="mouse"){Z=ad-I}else{Z=M-J.dropShadowSteps}}}}if(af==""){N<y?af="left":af="right"}j.css({top:Z+"px"}).removeClass().addClass("clue-"+af+"-"+v).addClass(" cluetip-"+v);if(J.arrows){var ag=(M-Z-J.dropShadowSteps);g.css({top:(/(left|right)/.test(af)&&N>=0&&ag>0)?ag+"px":/(left|right)/.test(af)?0:""}).show()}else{g.hide()}k=m(J);if(k&&k.length){k.hide().css({height:D,width:C,zIndex:z.data("cluetip").zIndex-1}).show()}j.hide()[J.fx.open](J.fx.openSpeed||0);if(f.fn.bgiframe){j.bgiframe()}if(J.delayedClose>0){S=setTimeout(G,J.delayedClose)}J.onShow.call(w,j,i)};var X=function(ab){T=false;b.hide();if(!J.sticky||(/click|toggle/).test(J.activation)){G();clearTimeout(S)}if(J.hoverClass){z.removeClass(J.hoverClass)}};var G=function(){h.parent().hide().removeClass();J.onHide.call(w,j,i);z.removeClass("cluetip-clicked");if(K){z.attr(J.titleAttribute,K)}z.css("cursor","");if(J.arrows){g.css({top:""})}};f(document).bind("hideCluetip",function(ab){G()});if((/click|toggle/).test(J.activation)){z.bind("click.cluetip",function(ab){if(j.is(":hidden")||!z.is(".cluetip-clicked")){A(ab);f(".cluetip-clicked").removeClass("cluetip-clicked");z.addClass("cluetip-clicked")}else{X(ab)}this.blur();return false})}else{if(J.activation=="focus"){z.bind("focus.cluetip",function(ab){A(ab)});z.bind("blur.cluetip",function(ab){X(ab)})}else{z[J.clickThrough?"unbind":"bind"]("click",Y);var t=function(ab){if(J.tracking==true){var ad=N-ab.pageX;var ac=Z?Z-ab.pageY:M-ab.pageY;z.bind("mousemove.cluetip",function(ae){j.css({left:ae.pageX+ad,top:ae.pageY+ac})})}};if(f.fn.hoverIntent&&J.hoverIntent){z.hoverIntent({sensitivity:J.hoverIntent.sensitivity,interval:J.hoverIntent.interval,over:function(ab){A(ab);t(ab)},timeout:J.hoverIntent.timeout,out:function(ab){X(ab);z.unbind("mousemove.cluetip")}})}else{z.bind("mouseenter.cluetip",function(ab){A(ab);t(ab)}).bind("mouseleave.cluetip",function(ab){X(ab);z.unbind("mousemove.cluetip")})}z.bind("mouseover.cluetip",function(ab){z.attr("title","")}).bind("mouseleave.cluetip",function(ab){z.attr("title",z.data("cluetip").title)})}}});function m(t,w){var s=(t.dropShadow&&t.dropShadowSteps)?+t.dropShadowSteps:0;if(f.support.boxShadow){var r=s===0?"0 0 ":"1px 1px ";f("#cluetip").css(f.support.boxShadow,r+s+"px rgba(0,0,0,0.5)");return false}var q=f("#cluetip .cluetip-drop-shadow");if(s==q.length){return q}q.remove();var v=[];for(var u=0;u<s;){v[u++]='<div style="top:'+u+"px;left:"+u+'px;"></div>'}w=f(v.join("")).css({position:"absolute",backgroundColor:"#000",zIndex:n-1,opacity:0.1}).addClass("cluetip-drop-shadow").prependTo("#cluetip");return w}return this};(function(){f.support=f.support||{};var l=document.createElement("div"),n=l.style,u=["boxShadow"],s=["moz","Moz","webkit","o"];for(var t=0,p=u.length;t<p;t++){var m=u[t],o=m.charAt(0).toUpperCase()+m.slice(1);if(typeof n[m]!=="undefined"){f.support[m]=m}else{for(var r=0,q=s.length;r<q;r++){if(typeof n[s[r]+o]!=="undefined"){f.support[m]=s[r]+o;break}}}}l=null;delete l})();f.fn.cluetip.defaults={width:275,height:"auto",cluezIndex:97,positionBy:"auto",topOffset:15,leftOffset:15,local:false,localPrefix:null,localIdSuffix:null,hideLocal:true,attribute:"rel",titleAttribute:"title",splitTitle:"",escapeTitle:false,showTitle:true,cluetipClass:"default",hoverClass:"",waitImage:true,cursor:"help",arrows:false,dropShadow:true,dropShadowSteps:6,sticky:false,mouseOutClose:false,activation:"hover",clickThrough:false,tracking:false,delayedClose:0,closePosition:"top",closeText:"Close",truncate:0,fx:{open:"show",openSpeed:""},hoverIntent:{sensitivity:3,interval:50,timeout:0},onActivate:function(l){return true},onShow:function(m,l){},onHide:function(m,l){},ajaxCache:true,ajaxProcess:function(l){l=l.replace(/<(script|style|title)[^<]+<\/(script|style|title)>/gm,"").replace(/<(link|meta)[^>]+>/g,"");return l},ajaxSettings:{dataType:"html"},debug:false};var c="appendTo",a="body";f.cluetip.setup=function(l){if(l&&l.insertionType&&(l.insertionType).match(/appendTo|prependTo|insertBefore|insertAfter/)){c=l.insertionType}if(l&&l.insertionElement){a=l.insertionElement}}})(jQuery);
